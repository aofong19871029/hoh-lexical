import{r,af as d,ag as M,t as T,j as D}from"./main-0eG-CwhZ.js";function g(e){const a=e.transform();return a!==null?new Set([a]):new Set}function R({initialEditor:e,children:a,initialNodes:u,initialTheme:C,skipCollabChecks:h}){const m=r.useRef(!1),l=r.useContext(d);if(l==null)throw Error("Unexpected parent context null on a nested composer");const[o,{getTheme:_}]=l,y=r.useMemo(()=>{const n=C||_()||void 0,K=M(l,n);if(n!==void 0&&(e._config.theme=n),e._parentEditor=o,u)for(let s of u){let c=null,t=null;if(typeof s!="function"){const f=s;s=f.replace,c=f.with,t=f.withKlass||null}const x=e._nodes.get(s.getType());e._nodes.set(s.getType(),{exportDOM:x?x.exportDOM:void 0,klass:s,replace:c,replaceWithKlass:t,transforms:g(s)})}else{const s=e._nodes=new Map(o._nodes);for(const[c,t]of s)e._nodes.set(c,{exportDOM:t.exportDOM,klass:t.klass,replace:t.replace,replaceWithKlass:t.replaceWithKlass,transforms:g(t.klass)})}return e._config.namespace=o._config.namespace,e._editable=o._editable,[e,K]},[]),{isCollabActive:b,yjsDocMap:w}=T(),p=h||m.current||w.has(e.getKey());return r.useEffect(()=>{p&&(m.current=!0)},[p]),r.useEffect(()=>o.registerEditableListener(n=>{e.setEditable(n)}),[e,o]),D.jsx(d.Provider,{value:y,children:!b||p?a:null})}export{R as L};
